/** biome-ignore-all lint/a11y/noSvgWithoutTitle: SVGs are icons and don't need a title */
"use client";

import { Store, useStore } from "@tanstack/react-store";
import React, { type JSX, useEffect } from "react";

interface ProgrammingLang {
  name: string;
  disabled?: boolean;
  icon: () => JSX.Element;
}

const PROGRAMMING_LANGUAGES: ProgrammingLang[] = [
  {
    disabled: true,
    name: "Python",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 16 16"
      >
        <path
          fill="currentColor"
          d="M7.949,1C4.395,1,4.617,2.549,4.617,2.549l0,1.605H8.013V4.636H3.274S1,4.377,1,7.982s1.985,3.477,1.985,3.477H4.169V9.786a1.89,1.89,0,0,1,1.953-2H9.487a1.81,1.81,0,0,0,1.89-1.836V2.868S11.664,1,7.949,1h0ZM6.079,2.079a0.613,0.613,0,1,1-.61.613A0.611,0.611,0,0,1,6.079,2.079ZM8.052,15c3.554,0,3.332-1.549,3.332-1.549l0-1.605H7.988V11.364h4.739S15,11.623,15,8.018s-1.985-3.477-1.985-3.477H11.832V6.214a1.89,1.89,0,0,1-1.953,2H6.514a1.81,1.81,0,0,0-1.89,1.836v3.087S4.337,15,8.052,15h0Zm1.87-1.079a0.613,0.613,0,1,1,.61-0.613A0.611,0.611,0,0,1,9.922,13.921Z"
        />
      </svg>
    ),
  },
  {
    name: "Rust",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 2048 2048"
      >
        <path
          fill="currentColor"
          d="M2048 1024q0 17-14 25l-87 54q-1 6-1 12t-1 12l75 70q9 8 9 21q0 8-5 16t-14 12l-96 35q-2 6-3 11t-4 12q4 6 15 19t22 29t19 30t9 22q0 11-6 19t-18 11l-102 16q-2 5-5 10t-6 11l11 22q7 14 15 31t13 30t6 23q0 13-8 21t-20 8h-2l-103-4l-15 18q2 10 6 24t9 30t7 30t3 23q0 12-9 21t-21 9q-7 0-21-3t-31-7t-32-9t-23-6l-18 15l4 103v2q0 12-8 20t-21 8q-8 0-22-5t-31-13t-30-15t-23-12l-10 6q-5 3-11 5l-16 102q-2 11-10 17t-19 7q-8 0-22-8t-30-20t-29-21t-20-16q-6 2-11 3t-12 4l-35 96q-3 8-11 13t-17 6q-14 0-21-9l-70-75q-6 1-12 1t-12 1l-54 87q-8 14-25 14t-25-14l-54-87q-6-1-12-1t-12-1l-70 75q-8 9-21 9q-8 0-16-5t-12-14l-35-96q-6-2-11-3t-12-4q-6 5-19 15t-29 22t-30 19t-22 9q-11 0-19-6t-11-18l-16-102q-5-2-10-5t-11-6l-22 11q-14 7-31 15t-30 13t-23 6q-13 0-21-8t-8-20v-2l4-103l-18-15q-10 2-24 6t-30 9t-30 7t-23 3q-12 0-21-9t-9-21q0-7 3-21t7-31t9-32t6-23l-15-18l-103 4h-2q-12 0-20-8t-8-21q0-8 5-22t13-31t15-30t12-23l-6-10q-3-5-5-11l-102-16q-11-2-17-10t-7-20q0-7 8-21t20-30t21-29t16-20q-2-6-3-11t-4-12l-96-35q-8-3-13-11t-6-17q0-13 9-21l75-70q-1-6-1-12t-1-12l-87-54q-14-8-14-25t14-25l87-54q1-6 1-12t1-12l-75-70q-9-7-9-21q0-8 5-16t14-12l96-35q2-6 3-11t4-12q-5-6-15-19t-22-29t-19-30t-9-22q0-11 6-19t18-11l102-16q2-5 5-10t6-11l-11-22q-7-14-15-31t-13-30t-6-23q0-12 8-20t20-9h2l103 4l15-18q-2-10-6-24t-9-30t-7-30t-3-23q0-12 9-21t21-9q7 0 21 3t31 7t32 9t23 6l18-15l-4-103v-2q0-12 8-20t21-8q8 0 22 5t31 13t30 15t23 12l10-6q5-3 11-5l16-102q2-11 10-17t20-7q7 0 21 8t30 20t29 22t20 15q5-2 11-3t12-4l35-96q3-8 11-13t17-6q13 0 21 9l70 75q6-1 12-1t12-1l54-87q8-14 25-14t25 14l54 87q6 1 12 1t12 1l70-75q7-9 21-9q8 0 16 5t12 14l35 96q6 2 11 3t12 4q6-4 19-15t29-22t30-19t23-9q10 0 18 6t11 18l16 102q5 2 10 5t11 6l22-11q14-7 31-15t30-13t23-6q12 0 20 8t9 20v2l-4 103l18 15q10-2 24-6t30-9t30-7t23-3q12 0 21 9t9 21q0 7-3 21t-7 31t-9 32t-6 23l15 18l103-4h2q12 0 20 8t8 21q0 8-5 22t-13 31t-15 30t-12 23l6 10q3 5 5 11l102 16q11 2 17 10t7 20q0 8-8 22t-20 29t-22 29t-15 20q2 6 3 11t4 12l96 35q8 3 13 11t6 17q0 14-9 21l-75 70q1 6 1 12t1 12l87 54q14 8 14 25m-489 519q36-36 69-80h-316q-18 0-35-11t-32-27t-26-34t-16-34q-12-34-18-79t-20-87t-40-69t-77-29H854v138h179q4 0 8 1t4 6v217q0 5-4 6t-8 2H420q15 20 31 39t34 37q12-3 31-7t39-9t38-8t30-4q20 0 34 12t20 32l31 143q151 70 316 70q161 0 309-67l31-143q5-20 20-32t35-12q11 0 30 3t39 9t39 9t32 8m-26 110q0-26-17-43t-44-18q-25 0-43 18t-18 43q0 26 17 43t44 18q26 0 43-17t18-44m-963 59q26 0 43-18t17-44t-17-43t-43-17q-25 0-43 17t-18 43t17 44t44 18M294 731q-25 0-43 18t-18 43t18 43t43 18q26 0 43-17t18-44q0-26-17-43t-44-18m-16 206q-2 20-3 40t-1 40q0 104 29 206h214V744H411q8 17 20 40t12 44q0 17-9 30t-24 20zm576-47h235q15 0 34-3t36-10t28-20t12-33q0-16-9-30t-22-24t-30-15t-31-6H854zm918 183q1-14 1-28t1-29q0-18-1-36t-3-37l-138-61q-15-7-24-21t-9-30q0-10 10-35t23-55t26-56t18-39q-41-72-96-132t-121-107t-141-79t-156-48l-105 100q-18 16-38 16q-25 0-40-17l-94-99q-121 23-229 84T465 517h796q49 0 99 19t90 54t65 80t25 98q0 36-13 67t-36 57t-49 49t-56 40q33 26 52 46t32 41t20 49t18 69q3 11 12 18t20 13t24 7t22 3q50 0 74-29t24-77v-9q0-6-1-13q0-10 2-18t10-8zM960 241q0 25 18 43t43 18t43-18t18-43q0-26-17-43t-44-18q-26 0-43 17t-18 44m787 615q26 0 43-17t18-44q0-26-17-43t-44-18q-25 0-43 18t-18 43t18 43t43 18"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "TypeScript",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 24 24"
      >
        <g fill="none">
          <g clipPath="url(#SVGXv8lpc2Y)">
            <path
              fill="currentColor"
              d="M23.429 0H.57A.57.57 0 0 0 0 .571V23.43a.57.57 0 0 0 .571.571H23.43a.57.57 0 0 0 .571-.571V.57a.57.57 0 0 0-.572-.57m-9.143 12.826h-2.857v8.888H9.143v-8.888H6.286v-1.969h8zm.64 8.38v-2.375s1.298.978 2.855.978s1.497-1.018 1.497-1.158c0-1.477-4.412-1.477-4.412-4.751c0-4.452 6.429-2.695 6.429-2.695l-.08 2.116s-1.078-.719-2.296-.719s-1.657.58-1.657 1.198c0 1.597 4.452 1.438 4.452 4.652c0 4.95-6.788 2.755-6.788 2.755"
            />
          </g>
          <defs>
            <clipPath id="SVGXv8lpc2Y">
              <path fill="#fff" d="M0 0h24v24H0z" />
            </clipPath>
          </defs>
        </g>
      </svg>
    ),
  },
  {
    disabled: true,
    name: "JavaScript",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 24 24"
      >
        <g fill="none">
          <g clipPath="url(#SVGXv8lpc2Y)">
            <path
              fill="currentColor"
              fillRule="evenodd"
              d="M0 0h24v24H0zm18.347 20.12c-1.113 0-1.742-.58-2.225-1.37l-1.833 1.065c.662 1.308 2.015 2.306 4.11 2.306c2.142 0 3.737-1.112 3.737-3.143c0-1.883-1.082-2.72-2.998-3.543l-.564-.241c-.968-.42-1.387-.693-1.387-1.37c0-.547.42-.966 1.08-.966c.647 0 1.064.273 1.451.966l1.756-1.127c-.743-1.307-1.773-1.806-3.207-1.806c-2.014 0-3.303 1.288-3.303 2.98c0 1.835 1.08 2.704 2.708 3.397l.564.242c1.029.45 1.642.724 1.642 1.497c0 .646-.597 1.113-1.531 1.113m-8.74-.015c-.775 0-1.098-.53-1.452-1.16l-1.836 1.112c.532 1.126 1.578 2.06 3.383 2.06c1.999 0 3.368-1.063 3.368-3.398v-7.7h-2.255v7.67c0 1.127-.468 1.416-1.209 1.416"
              clipRule="evenodd"
            />
          </g>
          <defs>
            <clipPath id="SVGXv8lpc2Y">
              <path fill="#fff" d="M0 0h24v24H0z" />
            </clipPath>
          </defs>
        </g>
      </svg>
    ),
  },
  {
    disabled: true,
    name: "Java",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 24 24"
      >
        <path
          fill="currentColor"
          d="M10.82 8.427c-.76-1.085-1.046-1.872-1.108-2.445c-.059-.54.073-.97.335-1.383c.283-.447.708-.862 1.248-1.353c.505-.458 1.137-1.003 1.633-1.62L11.37.374c-.416.517-.928.947-1.418 1.391c-.534.485-1.149 1.062-1.593 1.764c-.466.735-.75 1.611-.635 2.67c.112 1.026.588 2.132 1.458 3.375zm1.25-3.03c.284-.684.861-1.37 1.78-2.156l1.3 1.518c-.831.713-1.129 1.153-1.235 1.407c-.104.25-.035.499.035.747c.084.296.223.79.214 1.322c-.012.706-.254 1.452-.832 2.32l-1.664-1.11c.422-.632.492-1.01.496-1.243c.005-.295-.072-.46-.197-.96c-.12-.478-.21-1.097.102-1.845M6.141 10c.47-.314 1.05-.474 1.592-.604L7.266 7.45c-.813.196-1.551.46-2.112.807C4.644 8.573 4 9.136 4 10c0 .726.486 1.306 1.065 1.686a2.5 2.5 0 0 0-.065.572c0 .98.418 1.807 1.143 2.42c-.107.3-.155.634-.14.968c-.777.151-1.536.373-2.17.664c-.432.198-.858.451-1.19.777c-.334.329-.643.804-.643 1.413c0 .427.189.772.374 1.01c.189.242.432.449.684.624c.506.351 1.184.669 1.959.936c1.558.538 3.669.93 5.983.93c3.327 0 5.663-.384 7.19-.782a13 13 0 0 0 1.704-.561c.21-.088.42-.181.616-.297c.01-.006-1.028-1.715-1.024-1.718c-.564.294-1.188.48-1.8.64c-1.349.352-3.513.718-6.686.718c-2.104 0-3.993-.358-5.33-.82c-.532-.184-1.088-.398-1.541-.74c.115-.09.29-.199.538-.312c.558-.256 1.323-.466 2.14-.591q.344.365.814.64c.965.562 2.292.823 3.879.823c1.31 0 2.258-.132 2.898-.274c.356-.078.714-.167 1.042-.328c.003-.002-.881-1.795-.881-1.795q-.291.105-.593.17c-.489.109-1.29.227-2.466.227c-1.413 0-2.336-.24-2.871-.551c-.426-.248-.589-.524-.622-.824c.868.253 1.895.375 3.056.375c1.463 0 2.518-.143 3.228-.297c.386-.083.775-.179 1.134-.346c.02-.01-.857-1.807-.857-1.807a4.4 4.4 0 0 1-.7.198c-.56.121-1.473.252-2.806.252c-1.603 0-2.67-.264-3.302-.623c-.471-.268-.678-.568-.74-.89c1.24.326 2.805.513 4.48.513c1.817 0 3.502-.22 4.783-.598l-.566-1.918c-1.054.311-2.54.516-4.217.516c-1.724 0-3.245-.216-4.302-.542c-.5-.153-.846-.316-1.056-.458m11.448.746c1.213-.11 1.66.188 1.804.342c.149.16.201.408.136.67c-.116.464-.443.914-.973 1.328c-.529.413-1.2.74-1.873.965l.632 1.897c.828-.276 1.718-.698 2.471-1.285c.75-.586 1.424-1.385 1.683-2.42c.185-.74.112-1.741-.614-2.52c-.73-.782-1.909-1.109-3.447-.969z"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "PHP",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 512 512"
      >
        <path
          fill="currentColor"
          d="M170.322 349.808c-2.4-15.66-9-28.38-25.02-34.531c-6.27-2.4-11.7-6.78-17.88-9.54c-7.02-3.15-14.16-6.15-21.57-8.1c-5.61-1.5-10.83 1.02-14.16 5.94c-3.15 4.62-.87 8.97 1.77 12.84c2.97 4.35 6.27 8.49 9.6 12.57c5.52 6.78 11.37 13.29 16.74 20.161c5.13 6.57 9.51 13.86 8.76 22.56c-1.65 19.08-10.29 34.891-24.21 47.76c-1.53 1.38-4.23 2.37-6.21 2.19c-8.88-.96-16.95-4.32-23.46-10.53c-7.47-7.11-6.33-15.48 2.61-20.67c2.13-1.23 4.35-2.37 6.3-3.87c5.46-4.11 7.29-11.13 4.32-17.22c-1.41-2.94-3-6.12-5.34-8.25c-11.43-10.41-22.651-21.151-34.891-30.63C18.01 307.447 2.771 276.968.43 240.067c-2.64-40.981 6.87-79.231 28.5-114.242c8.19-13.29 17.73-25.951 32.37-32.52c9.96-4.47 20.88-6.99 31.531-9.78c29.311-7.71 58.89-13.5 89.401-8.34c26.28 4.41 45.511 17.94 54.331 43.77c5.79 16.89 7.17 34.35 5.37 52.231c-3.54 35.131-29.49 66.541-63.331 75.841c-14.67 4.02-22.68 1.77-31.5-10.44c-6.33-8.79-11.58-18.36-17.25-27.631c-.84-1.38-1.44-2.97-2.16-4.44c-.69-1.47-1.44-2.88-2.16-4.35c2.13 15.24 5.67 29.911 13.98 42.99c4.5 7.11 10.5 12.36 19.29 13.14c32.34 2.91 59.641-7.71 79.021-33.721c21.69-29.101 26.461-62.581 20.19-97.831c-1.23-6.96-3.3-13.77-4.77-20.7c-.99-4.47.78-7.77 5.19-9.33c2.04-.69 4.14-1.26 6.18-1.68c26.461-5.7 53.221-7.59 80.191-4.86c30.601 3.06 59.551 11.46 85.441 28.471c40.531 26.67 65.641 64.621 79.291 110.522c1.98 6.66 2.28 13.95 2.46 20.971c.12 4.68-2.88 5.91-6.45 2.97c-3.93-3.21-7.53-6.87-10.92-10.65c-3.15-3.57-5.67-7.65-8.73-11.4c-2.37-2.94-4.44-2.49-5.58 1.17c-.72 2.22-1.35 4.41-1.98 6.63c-7.08 25.26-18.24 48.3-36.33 67.711c-2.52 2.73-4.77 6.78-5.07 10.38c-.78 9.96-1.35 20.13-.39 30.06c1.98 21.331 5.07 42.57 7.47 63.871c1.35 12.03-2.52 19.11-13.83 23.281c-7.95 2.91-16.47 5.04-24.87 5.64c-13.38.93-26.88.27-40.32.27c-.36-15 .93-29.731-13.17-37.771c2.73-11.13 5.88-21.69 7.77-32.49c1.56-8.97.24-17.79-6.06-25.14c-5.91-6.93-13.32-8.82-20.101-4.86c-20.43 11.91-41.671 11.97-63.301 4.17c-9.93-3.6-16.86-1.56-22.351 7.5c-5.91 9.75-8.4 20.7-7.74 31.771c.84 13.95 3.27 27.75 5.13 41.64c1.02 7.77.15 9.78-7.56 11.76c-17.13 4.35-34.56 4.83-52.081 3.42c-.93-.09-1.86-.48-2.46-.63c-.87-14.55.66-29.671-16.68-37.411c7.68-16.29 6.63-33.18 3.99-50.07l-.06-.15zm-103.561-57.09c2.55-2.4 4.59-6.15 5.31-9.6c1.8-8.64-4.68-20.22-12.18-23.43c-3.99-1.74-7.47-1.11-10.29 2.07c-6.87 7.77-13.65 15.63-20.401 23.521c-1.14 1.35-2.16 2.94-2.97 4.53c-2.7 5.19-1.11 8.97 4.65 10.38c3.48.87 7.08 1.05 10.65 1.56c9.3-.9 18.3-2.46 25.23-9zm.78-86.371c-.03-6.18-5.19-11.34-11.28-11.37c-6.27-.03-11.67 5.58-11.46 11.76c.27 6.21 5.43 11.19 11.61 11.07c6.24-.09 11.22-5.19 11.16-11.43z"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "Go",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 32 32"
      >
        <path
          fill="currentColor"
          d="M2 12h4v2H2zm-2 4h6v2H0zm4 4h2v2H4zm16.954-5H14v3h3.239a4.42 4.42 0 0 1-3.531 2a2.65 2.65 0 0 1-2.053-.858a2.86 2.86 0 0 1-.628-2.28A4.515 4.515 0 0 1 15.292 13a2.73 2.73 0 0 1 1.749.584l2.962-1.185A5.6 5.6 0 0 0 15.292 10a7.526 7.526 0 0 0-7.243 6.5a5.614 5.614 0 0 0 5.659 6.5a7.526 7.526 0 0 0 7.243-6.5a6.4 6.4 0 0 0 .003-1.5"
        />
        <path
          fill="currentColor"
          d="M26.292 10a7.526 7.526 0 0 0-7.243 6.5a5.614 5.614 0 0 0 5.659 6.5a7.526 7.526 0 0 0 7.243-6.5a5.614 5.614 0 0 0-5.659-6.5m2.681 6.137A4.515 4.515 0 0 1 24.708 20a2.65 2.65 0 0 1-2.053-.858a2.86 2.86 0 0 1-.628-2.28A4.515 4.515 0 0 1 26.292 13a2.65 2.65 0 0 1 2.053.858a2.86 2.86 0 0 1 .628 2.28Z"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "C",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 24 24"
      >
        <path
          fill="currentColor"
          fillRule="evenodd"
          d="M11.199.914a1.5 1.5 0 0 1 1.602 0l8.5 5.369A1.5 1.5 0 0 1 22 7.55v8.898a1.5 1.5 0 0 1-.699 1.268l-8.5 5.368a1.5 1.5 0 0 1-1.602 0l-8.5-5.368A1.5 1.5 0 0 1 2 16.449V7.55a1.5 1.5 0 0 1 .699-1.268zm1.722 14.096a3.14 3.14 0 0 0 1.583-1.08l2.746 1.57a6.283 6.283 0 1 1 0-7l-2.746 1.57a3.142 3.142 0 1 0-1.583 4.94"
          clipRule="evenodd"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "C++",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 24 24"
      >
        <path
          fill="currentColor"
          fillRule="evenodd"
          d="M12.801.914a1.5 1.5 0 0 0-1.602 0l-8.5 5.369A1.5 1.5 0 0 0 2 7.55v8.898c0 .514.264.993.699 1.268l8.5 5.368a1.5 1.5 0 0 0 1.602 0l8.5-5.368A1.5 1.5 0 0 0 22 16.449V7.55a1.5 1.5 0 0 0-.699-1.268zm.703 13.015a3.141 3.141 0 1 1 0-3.86L16.25 8.5a6.283 6.283 0 1 0 0 7zM14.75 11.5v-.75h1v.75h.75v1h-.75v.75h-1v-.75H14v-1zm3.5 1.75v-.75h-.75v-1h.75v-.75h1v.75H20v1h-.75v.75z"
          clipRule="evenodd"
        />
      </svg>
    ),
  },
  {
    disabled: true,
    name: "Ruby",
    icon: () => (
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="1em"
        height="1em"
        viewBox="0 0 128 128"
      >
        <path
          fill="currentColor"
          d="m35.971 111.33l81.958 11.188c-9.374-15.606-18.507-30.813-27.713-46.144Zm89.71-86.383L93.513 73.339c-.462.696-1.061 1.248-.41 2.321c8.016 13.237 15.969 26.513 23.942 39.777c1.258 2.095 2.53 4.182 4.157 6.192l4.834-96.58zM16.252 66.22c.375.355 1.311.562 1.747.347c7.689-3.779 15.427-7.474 22.948-11.564c2.453-1.333 4.339-3.723 6.452-5.661c6.997-6.417 13.983-12.847 20.966-19.278c.427-.395.933-.777 1.188-1.275c2.508-4.902 4.973-9.829 7.525-14.898c-3.043-1.144-5.928-2.263-8.849-3.281c-.396-.138-1.02.136-1.449.375c-6.761 3.777-13.649 7.353-20.195 11.472c-3.275 2.061-5.943 5.098-8.843 7.743c-4.674 4.266-9.342 8.542-13.948 12.882a24 24 0 0 0-3.288 3.854c-3.15 4.587-6.206 9.24-9.402 14.025c1.786 1.847 3.41 3.613 5.148 5.259m28.102-6.271l-11.556 48.823l54.3-34.987zm76.631-34.846l-46.15 7.71l15.662 38.096zM44.996 56.644l41.892 13.6c-5.25-12.79-10.32-25.133-15.495-37.737ZM16.831 75.643L2.169 110.691l27.925-.825Zm13.593 26.096l.346-.076c3.353-13.941 6.754-27.786 10.177-42.272L18.544 71.035c3.819 9.926 7.891 20.397 11.88 30.704m84.927-78.897c-4.459-1.181-8.918-2.366-13.379-3.539c-6.412-1.686-12.829-3.351-19.237-5.052c-.801-.213-1.38-.352-1.851.613c-2.265 4.64-4.6 9.245-6.901 13.868c-.071.143-.056.328-.111.687l41.47-6.285zM89.482 12.288l36.343 10.054l-6.005-17.11l-30.285 6.715ZM33.505 114.007c-4.501-.519-9.122-.042-13.687.037c-3.75.063-7.5.206-11.25.323c-.386.012-.771.09-1.156.506q46.504 4.298 93.007 8.6l.063-.414l-29.815-4.07c-12.384-1.691-24.747-3.551-37.162-4.982M2.782 99.994c3.995-9.27 7.973-18.546 11.984-27.809c.401-.929.37-1.56-.415-2.308c-1.678-1.597-3.237-3.318-5.071-5.226c-2.479 12.24-4.897 24.177-7.317 36.113l.271.127c.185-.297.411-.578.548-.897m78.74-90.153c6.737-1.738 13.572-3.097 20.367-4.613c.44-.099.87-.244 1.303-.368l-.067-.332l-29.194 3.928c2.741 1.197 4.853 2.091 7.591 1.385"
        />
      </svg>
    ),
  },
];

const currentlyUsedLangStore = new Store("");

export function ProgrammingLanguage() {
  const lang = useStore(currentlyUsedLangStore);
  return <span>{lang}</span>;
}

export function RenderProgrammingLanguageBased(props: {
  children: JSX.Element;
  target_name: string;
}) {
  const lang = useStore(currentlyUsedLangStore);
  return props.target_name === lang && props.children;
}

export default function ProgrammingLangToggle() {
  const [currentIndexPL, setCurrentIndexPL] = React.useState<
    number | undefined
  >(undefined);
  const [shouldMenuShow, setShouldMenuShow] = React.useState(false);

  useEffect(() => {
    if (currentIndexPL === undefined) return;
    let nextIndex = currentIndexPL;

    while (PROGRAMMING_LANGUAGES[nextIndex].disabled) {
      nextIndex = (nextIndex + 1) % PROGRAMMING_LANGUAGES.length;
      if (nextIndex === currentIndexPL) return;
    }

    if (nextIndex !== currentIndexPL) {
      setCurrentIndexPL(nextIndex);
      return;
    }
    currentlyUsedLangStore.setState(
      () => PROGRAMMING_LANGUAGES[currentIndexPL].name,
    );
    localStorage.setItem(
      "selected-programming-lang-idx",
      currentIndexPL.toString(10),
    );
  }, [currentIndexPL]);

  useEffect(() => {
    const lang_idx_str = localStorage.getItem("selected-programming-lang-idx");
    if (lang_idx_str) {
      const lang_idx = parseInt(lang_idx_str, 10);
      setCurrentIndexPL(lang_idx);
      return;
    }
    setCurrentIndexPL(0);
  }, []);

  return (
    <div className="relative inline-flex z-100">
      <button
        type={"button"}
        className="flex items-center justify-between w-full group hover:bg-fd-muted-foreground/10 rounded py-1.5 px-2"
        onClick={() => {
          setShouldMenuShow(true);
          document.documentElement.addEventListener("click", () => {
            setShouldMenuShow(false);
          });
        }}
      >
        {currentIndexPL !== undefined && (
          <div className="flex items-center gap-2">
            <div className="text-2xl p-1.5 bg-fd-muted rounded border border-fd-muted-foreground/25">
              {PROGRAMMING_LANGUAGES[currentIndexPL].icon()}
            </div>
            <div className="select-none font-semibold font-mono">
              {PROGRAMMING_LANGUAGES[currentIndexPL].name}
            </div>
          </div>
        )}
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="1em"
          height="1em"
          viewBox="0 0 16 16"
        >
          <path
            fill="currentColor"
            fillRule="evenodd"
            d="M8 1a.5.5 0 0 1 .374.168l4 4.5l-.748.664L8 2.252l-3.626 4.08l-.748-.664l4-4.5A.5.5 0 0 1 8 1m0 12.747l-3.626-4.08l-.748.665l4 4.5a.5.5 0 0 0 .748 0l4-4.5l-.748-.664z"
            clipRule="evenodd"
          />
        </svg>
      </button>

      <div
        role="menu"
        className={`absolute top-12 z-auto w-56 overflow-hidden rounded-lg border border-fd-border bg-fd-background
                ${shouldMenuShow ? "scale-100 opacity-100" : "opacity-0 scale-90 pointer-events-none"} transition duration-100`}
      >
        {PROGRAMMING_LANGUAGES.map((lang, idx) => (
          <button
            type="button"
            className={`w-full justify-between flex px-3 py-2 text-sm font-medium transition-colors 
                        ${currentIndexPL === idx ? "bg-fd-secondary/30" : "hover:bg-fd-muted text-fd-foreground"}
                        ${lang.disabled ? "pointer-events-none opacity-30 bg-transparent hover:bg-transparent" : ""}
                        `}
            key={`programming-lang-select-${lang.name}`}
            onClick={() => setCurrentIndexPL(idx)}
          >
            <div className="flex gap-2">
              <div className="text-xl">{lang.icon()}</div>
              {lang.name}
            </div>
            {currentIndexPL === idx && (
              <div className="flex justify-center items-center text-sm text-fd-foreground">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="1em"
                  height="1em"
                  viewBox="0 0 20 20"
                >
                  <path fill="currentColor" d="m0 11l2-2l5 5L18 3l2 2L7 18z" />
                </svg>
              </div>
            )}
            {lang.disabled && (
              <div className="flex justify-center items-center text-sm text-fd-foreground">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="1em"
                  height="1em"
                  viewBox="0 0 24 24"
                >
                  <path
                    fill="currentColor"
                    fillRule="evenodd"
                    d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2S2 6.477 2 12s4.477 10 10 10m-4.906-3.68L18.32 7.094A8 8 0 0 1 7.094 18.32M5.68 16.906A8 8 0 0 1 16.906 5.68z"
                  />
                </svg>
              </div>
            )}
          </button>
        ))}
      </div>
    </div>
  );
}
